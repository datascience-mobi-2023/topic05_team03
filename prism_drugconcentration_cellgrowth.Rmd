
```{r}
# how is the correlation for different concentrations of drugs to the growth rate of the cell lines?

concentrations_nM <- c(0.6, 2.4, 9.8, 39.1, 156.3, 625, 10000, 2500)

cell_growth_rate_BRD_A00077618_236_07_6 <- prism[1, 1:8]

cell_growth_rate_BRD_A00758722_001_04_9 <- prism[1, 9:16]

BRD_A00077618_236_07_6 = c(t(cell_growth_rate_BRD_A00077618_236_07_6))
BRD_A00758722_001_04_9 = c(t(cell_growth_rate_BRD_A00758722_001_04_9))



plot(concentrations_nM, cell_growth_rate_BRD_A00758722_001_04_9, main="ACH_007", xlab="concentrations of drugs in nM", ylab="cell growth rate", pch=20, cex=1.5, col="green" )
points(concentration_nM, cell_growth_rate_BRD_A00077618_236_07_6, pch=20, cex=1.5, col="red")

cor(BRD_A00077618_236_07_6, BRD_A00758722_001_04_9, method = "pearson")

```


```{r}
# which drugs inhibit the cell growth rate in liver cancer cell lines?

# the indices of the liver cancer cell lines on the prism table:
liver_cancer_cell_lines
liver_cancer_cl_indices


for (x in liver_cancer_cl_indices)
    print(prism[x,])

# we created a new table by combining the rates of cell growth only for liver cancer cell lines:
prism_for_liver_cancer_cell_lines = rbind(prism[liver_cancer_cl_indices,])
prism_for_liver_cancer_cell_lines


# we should set a threshold for the growth rate to find out the most effective drugs to stop cell growth.

for (x in liver_cancer_cl_indices)
    print(colnames(prism[which(prism[x,]< -2)]))


# saving for-loop in a vector

inhibiting_drugs_liver_cancer <- character()
inhibiting_drugs_liver_cancer

for (x in liver_cancer_cl_indices) {
    my_out <- colnames(prism[which(prism[x,]< -2)])
    inhibiting_drugs_liver_cancer <- c(my_out)
}
    
inhibiting_drugs_liver_cancer

library(dplyr)

# z.B. the 10000 nM concentrated drug BRD-A00758722-001-04-9 inhibits the cell growth and we find out its mechanism from the table new_prism.treat:

new_prism.treat %>% filter_all(any_vars(. %in% c('BRD-A00758722-001-04-9')))

new_prism.treat %>% filter_all(any_vars(. %in% inhibiting_drugs_liver_cancer))


which(new_prism.treat[inhibiting_drugs_liver_cancer,])



```

